Implementing basics from http://blog.ezyang.com/2019/05/pytorch-internals/